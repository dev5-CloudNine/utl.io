<template name="jobNew">
    <div class="row">
        <div class="col-sm-12">
            <p>Your job post will remain on this portal for 90 days.  After 90 days the post will no longer appear. <br>You can either choose to publish to the portal or to your favorite providers only. <br>Upon publish, your account will be debited with proposed budget.</p>
            <br>
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4>Create Your Job Post</h4>
                </div>
                <div class="panel-body">
                    {{#autoForm id="jobNew" collection="Jobs" type="insert"}}
                        {{>jobFields}}
                        <div>
                            <button type="submit" class="btn btn-primary"><i class="fa fa-chevron-right"></i> Publish</button>
                            <button type="submit" class="btn btn-primary publishToFavs" value="favs">Publish to Fav's</button>
                            <!-- <button type="submit" class="btn btn-primary saveAsDraft" value="favs">Save as draft</button> -->
                            <button class="btn btn-primary publishInd" data-toggle="collapse" data-target="#publishIndividual">Publish to Individual</button>
                            <div id="publishIndividual" class="panel panel-white panel-collapse collapse">
                                <div class="panel-body">
                                    {{>providerList}}
                                    <button type="submit" class="btn btn-primary inviteIndividual">Publish to Individual</button>
                                </div>
                            </div>
                        </div>
                    {{/autoForm}}
                </div>
            </div>
        </div>
    </div>
</template>
<template name="providerList">
    <div class="form-group">
        <input type="text" data-schema-key="individualprovider" class="form-control proTypeahead" placeholder="Choose Provider" name="individualprovider" autocomplete="off" spellcheck="off" value="{{providerData}}" data-source="individualprovider" data-select="select" data-template="providerTemplate">
        <span class="help-block"></span>
    </div>
</template>
<template name="providerTemplate">
    <div class="form-group example-twitter oss">
        <p>{{readableId}}</p>
        <p>{{value}}</p>
        <p>{{title}}</p>
    </div>
</template>
<template name="jobEdit">
    <div class="row">
        <div class="col-sm-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4>Edit Job Post</h4>
                </div>
                <div class="panel-body">
                    <div class="form-group">
                        {{#autoForm id="jobEdit" collection="Jobs" doc=job type="update"}}
                            {{>jobFields}}
                            <div>
                                <button type="submit" class="btn btn-primary"><i class="fa fa-floppy-o"></i> Update</button>
                                <button id="cancel" class="btn btn-default"> Cancel</button>
                            </div>
                        {{/autoForm}}
                    </div>
                </div>
            </div>
        </div>
    </div>
</template>

<template name="duplicateJob">
    <div class="row">
        <div class="col-sm-12">
            <p>Your job post will remain on this portal for 90 days.  After 90 days the post will no longer appear. <br>You can either choose to publish to the portal or to your favorite providers only. <br>Upon publish, your account will be debited with proposed budget.</p>
            <br>
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4>Create Your Job Post</h4>
                </div>
                <div class="panel-body">
                    {{#autoForm id="jobNew" collection="Jobs" doc=job type="insert"}}
                        {{>jobFields}}
                        <div>
                            <button type="submit" class="btn btn-primary"><i class="fa fa-chevron-right"></i> Publish</button>
                            <button type="submit" class="btn btn-primary publishToFavs" value="favs">Publish to Fav's</button>
                        </div>
                    {{/autoForm}}
                </div>
            </div>
        </div>
    </div>
</template>

<template name="jobFields">
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            {{> afQuickField name='title' placeholder="This is the first thing providers see. So keep it precise and descriptive."}}
        </div>
        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
            {{>afQuickField name="jobtype" type="select" options=parentCategories}}
        </div>
        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
            {{>afQuickField name="jobSubCategory" type="select" options=childCategories}}
        </div>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <br>
            {{> afQuickField name='skillsrequired' placeholder="e.g. Cable Operator, DB Admin, Hardware.."}}
        </div>
    </div>
    {{> afQuickField name='description' rows=12 placeholder="Tell prospective service providers about this job in detail."}}
    <div class="row">
        <div class="col-xs-12">
            <button class="btn btn-success" data-toggle="modal" id="uploadDocs" data-target="#uploadJobDocs">Attach Documents</button>
        </div>
        <div class="col-xs-12">
            <div id="uploadJobDocs" class="modal fade" role="dialog">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button class="close" data-dismiss="modal" aria-label="close" type="button"><span aria-hidden="true">&times;</span></button>
                            <h4 class="modal-title">Select/Upload Documents</h4>
                        </div>
                        <div class="modal-body">
                            <div class="row">
                                <div class="col-xs-12 col-sm-3 col-md-3 col-lg-3">
                                    <div class="form-group">
                                        <div class="input-group">
                                            <label class="btn btn-success input-group-btn btn-lbl" data-toggle="tooltip" data-placement="top" style="font-size: 12px;">
                                                <input type="file" class="file_bag" multiple=true> Select from Computer
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                                    <label class="control-label">Select from the documents</label>
                                    <br>
                                    <div class="row">
                                        {{#each userDocuments}}
                                            <div class="col-md-3">
                                                <div class="thumbnail" style="position: relative;">
                                                    <span title="Remove" class="close-preview removeUserFile" data-url="{{file_url}}" style="cursor: pointer;">&times;</span>
                                                    <input type="checkbox" name="select_files" value="{{file_url}}" data-url="{{file_url}}" data-file-name="{{file_name}}">
                                                    <img src="{{this}}" style="height:100px;" onerror="this.src='/images/genericFile.jpg'">
                                                    <div class="caption" style="overflow: hidden;word-wrap: break-word;">
                                                        <a href="{{file_url}}" target="_blank">{{this.file_name}}</a>
                                                    </div>
                                                </div>
                                            </div>
                                        {{/each}}
                                        {{#if userDocuments}}
                                            <div class="col-sm-12">
                                                <div class="form-group">
                                                    <div class="input-group">
                                                        <button type="button" class="btn btn-success attachSelected">Attach</button>
                                                    </div>
                                                </div>
                                            </div>
                                        {{else}}
                                            <p>No files found. Please select from computer.</p>
                                        {{/if}}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-12">
            <div id="spinner">
                {{> spinner}}
            </div>
            {{#each uploadedFiles}}
                <div class="fileUploadProgress">
                    <div class="progress-bar progress-bar-striped" role="progressbar"
                    aria-valuenow="{{percent_uploaded}}" aria-valuemin="0" aria-valuemax="100" style="width:{{percent_uploaded}}%">{{percent_uploaded}}%</div>
                </div>
            {{/each}}
        </div>
            <!-- <ul class="fileList" style="list-style-type: none;">
                {{#each files}}
                    <li><i class="fa fa-times-circle remove-job-file" data-url="{{this.file_url}}" aria-hidden="true" title="Remove" style="cursor: pointer;"></i> <a href="{{this.file_url}}" target="_blank">{{this.file_name}}</a></li>
                {{/each}}
            </ul> -->
        <div class="fileList">
            {{#each files}}
                <div class="col-md-2">
                    <div class="thumbnail" style="position: relative;">
                        <span title="Remove" class="close-preview remove-job-file" data-url={{this.file_url}} style="cursor: pointer;">&times;</span>
                        <a href="{{this.file_path}}" target="_blank">
                          <img src="{{this}}" style="height:100px;" onerror="this.src='/images/genericFile.jpg'">
                        </a>
                        <div class="caption" style="overflow: hidden;word-wrap: break-word;">
                            <a href="{{this.file_path}}" target="_blank">{{this.file_name}}</a>
                        </div>
                    </div>
                </div>
            {{/each}}
        </div> 
    </div>
    <hr>
    <div class="row">
        <div class="col-sm-12">
            {{>afQuickField name="servicelocation"}}
        </div>
        {{#if afFieldValueIs name="servicelocation" value="Field Job"}}
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="form-group">
                    <label for="loc" class="control-label">Location Details</label>
                    {{>jobLocationMap}}
                </div>
            </div>
        {{/if}}
    </div>
    <hr>
    {{> afQuickField name='serviceschedule' noselect=true}}
    <div class="row">
        {{#if afFieldValueIs name="serviceschedule" value="exactdate"}}
            <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3">
                {{> afQuickField name="exactdate"}}
            </div>
            <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3">
                {{> afQuickField name="exacttime"}}
            </div>
        {{/if}}
        {{#if afFieldValueIs name="serviceschedule" value="betweendates"}}
            <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3">
                {{> afQuickField name="startdate"}}
            </div>
            <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3">
                {{> afQuickField name="enddate"}}
            </div>
            <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3">
                {{> afQuickField name="starttime"}}
            </div>
            <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3">
                {{> afQuickField name="endtime"}}
            </div>
        {{/if}}
    </div>
    <hr>
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <h5>Confidential Information (Only assigned providers can see this information)</h5>
        </div>
        <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
            {{>afQuickField name="contactperson" placeholder=""}}
        </div>
        <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
            {{>afQuickField name="contactemail"}}
        </div>
        <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
            {{>afQuickField name="contactphone"}}
        </div>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            {{> afQuickField name='confidentialDescription' rows=4 placeholder="All the information you write here will only be display to the assigned provider."}}
        </div>
    </div>
    <hr>
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
            {{> afQuickField name="ratebasis"}}
        </div>
        <div class="col-xs-12 col-sm-12 col-md-8 col-lg-8">
            {{#if afFieldValueIs name="ratebasis" value="Fixed Pay"}}
                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                    {{> afQuickField name="fixedamount" placeholder="Enter amount"}}
                    <label class="label-control">UTL Fees</label>
                    <span><input type="text" id="utl_fees" class="form-control" readonly="readonly" placeholder="5%"></span>
                    {{>afQuickField name="paidby"}}
                </div>
                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                    {{>afQuickField name="totalfromclient" readonly="true"}}
                    {{>afQuickField name="your_cost" readonly="true"}}
                    {{>afQuickField name="freelancer_nets" readonly="true"}}
                </div>
            {{/if}}

            {{#if afFieldValueIs name="ratebasis" value="Per Hour"}}
                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                    {{> afQuickField name="hourlyrate" placeholder="Enter amount per hour"}}
                    {{>afQuickField name="maxhours" placeholder="Maximum hours"}}
                    <label class="label-control">UTL Fees</label>
                    <span><input type="text" id="utl_fees" class="form-control" readonly="readonly" placeholder="5%"></span>
                    {{>afQuickField name="paidby"}}
                </div>
                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                    {{>afQuickField name="totalfromclient" readonly="true"}}
                    {{>afQuickField name="your_cost" readonly="true"}}
                    {{>afQuickField name="freelancer_nets" readonly="true"}}
                </div>
            {{/if}}
            {{#if afFieldValueIs name="ratebasis" value="Per Device"}}
                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                    {{> afQuickField name="rateperdevice" placeholder="Enter amount per device"}}
                    {{> afQuickField name="maxdevices" placeholder="Maximum devices"}}
                    <label class="label-control">UTL Fees</label>
                    <span><input type="text" id="utl_fees" class="form-control" readonly="readonly" placeholder="5%"></span>
                    {{>afQuickField name="paidby"}}
                </div>
                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                    {{>afQuickField name="totalfromclient" readonly="true"}}
                    {{>afQuickField name="your_cost" readonly="true"}}
                    {{>afQuickField name="freelancer_nets" readonly="true"}}
                </div>
            {{/if}}
            {{#if afFieldValueIs name="ratebasis" value="Blended"}}
                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                    {{>afQuickField name="payforfirsthours"}}
                    {{>afQuickField name="firsthours"}}
                    {{>afQuickField name="payfornexthours"}}
                    {{>afQuickField name="nexthours"}}
                    <label class="label-control">UTL Fees</label>
                    <span><input type="text" id="utl_fees" class="form-control" readonly="readonly" placeholder="5%"></span>
                    {{>afQuickField name="paidby"}}
                </div>
                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                    {{>afQuickField name="totalfromclient" readonly="true"}}
                    {{>afQuickField name="your_cost" readonly="true"}}
                    {{>afQuickField name="freelancer_nets" readonly="true"}}
                </div>
            {{/if}}
        </div>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <div class="alert alert-info enoughBalance" hidden>
                <strong>You have enough account balance. Your account will be debited once published.</strong>
            </div>
        </div>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <div class="alert alert-danger notEnoughBalance" hidden>
                <strong>You don't have enough account balance. Click on the button to deposit funds.</strong>
                <div>
                    <div id="payeezy-button" style="margin: 10px 0" onclick="document.getElementById('pay_now_form_148f147dea').submit()">
                        <form action="https://demo.globalgatewaye4.firstdata.com/pay" id="pay_now_form_148f147dea" method="post">
                            <input name="x_login" type="hidden" value="HCO-UTL-D-966" />
                            <input name="x_show_form" type="hidden" value="PAYMENT_FORM" />
                            <input name="x_fp_sequence" type="hidden" value="14686623761534527076" />
                            <input name="x_fp_hash" type="hidden" value="PNB-1.0-9a9d6d4b206fa02637f979843da3959c5e64aa9a" />
                            <input name="x_amount" type="hidden" value="" />
                            <input name="x_currency_code" type="hidden" value="USD" />
                            <input name="x_test_request" type="hidden" value="TRUE" />
                            <input name="x_relay_response" type="hidden" value="" />
                            <input name="donation_prompt" type="hidden" value="" />
                            <input name="button_code" type="hidden" value="Pay Now UTL DEMO0080 Payment Page" />
                            <div class="cpwrap">
                                <button type="button">Deposit funds</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <hr>
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            {{>afArrayField name="tasks"}}
        </div>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            {{>afArrayField name="shipment"}}
        </div>
    </div>
    <!-- <hr>
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            {{>afQuickField name="assignToProvider"}}
        </div>
    </div>
    <div class="row selectProviders" hidden>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            {{#each availableProviders}}
                <div class="radio-inline">
                    <label>
                        <input type="radio" name="selectedProviders" data-schema-key="selectedProviders" value="{{this._id}}">{{#with this}} <a href="{{pathFor 'profile'}}"> {{this.name}}</a>{{/with}}
                    </label>
                </div>
            {{/each}}
        </div>
    </div> -->
</template>

<template name="jobLocationMap">
    <div class="map-container">    
        <input type="text" id="loc" data-schema-key="location" name="location" class="form-control" value="{{locationData}}" data-source="location">
    </div>
    <div id="locationDetails" hidden>
        <input type="text" name="name" data-schema-key="fullLocation.street" class="form-control">
        <input type="text" name="sublocality" class="form-control" data-schema-key="fullLocation.sublocality">
        <input name="locality" type="text" value="" class="form-control" data-schema-key="fullLocation.locality">
        <input type="text" class="form-control" name="administrative_area_level_1" data-schema-key="fullLocation.state">
        <input type="text" class="form-control" name="formatted_address" data-schema-key="fullLocation.formatted_address">
        <input type="text" class="form-control" name="country" data-schema-key="fullLocation.country">
        <input type="text" class="form-control" name="postal_code" data-schema-key="fullLocation.zip">
        <input type="text" name="url" data-schema-key="fullLocation.mapLink" class="form-control">
        <input type="text" name="lat" data-schema-key="fullLocation.latitude" class="form-control">
        <input type="text" name="lng" data-schema-key="fullLocation.longitude" class="form-control">
    </div>
</template>