<template name="withdraw">
	<h5>Withdraw Funds</h5>
	<div class="panel panel-default">
		<div class="panel-body">
			{{#if dwollaCustomer}}
				{{#if fundingSourceUrl}}
					<form id="requestDwollaPay">
						<div class="row">
							<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
								<div class="form-group">
									<input type="number" pattern="[0-9]+([\,|\.][0-9]+)?" class="form-control" step="0.01" id="requestAmount" placeholder="Enter Amount To Withdraw" min="1" required><br>
									<button type="submit" class="btn btn-primary btn-sm submitWithdrawReq" disabled="true" data-loading-text="<i class='fa fa-circle-o-notch fa-spin'></i> OK wait...">Submit</button>
								</div>
							</div>
						</div>
						<div id="spinner">
							{{>spinner}}
						</div>
					</form>
					<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
					    <div class="alert alert-info enoughBalance" hidden>
			                <strong>You don't have sufficient account balance to make this request.</strong>
			            </div>
			        </div>
		        {{else}}
		        	<div class="row">
                        <div class="col-xs-6">
                            <div class="form-group">
                                <script src="https://cdn.dwolla.com/1/dwolla.js"></script>
                                <button class="btn btn-primary btn-sm startIav" data-loading-text="<i class='fa fa-circle-o-notch fa-spin'></i> OK wait...">Initiate Account Verification</button>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-12">
                            <div id="initiateProIav"></div>
                        </div>
                    </div>
		        {{/if}}
		    {{else}}
		    	<h4>Create Dwolla Account</h4>
		    	{{#if currentUser.isDeveloper}}
		    		<button class="btn btn-sm btn-primary" id="pro_register_dwolla"  data-loading-text="<i class='fa fa-circle-o-notch fa-spin'></i> OK wait...">Create Dwolla Customer</button>
		    	{{else}}
		    		You need to create your profile before registering with Dwolla. <a href="{{pathFor 'profileNew'}}">Click here</a> to create your provider profile.
		    	{{/if}}
	        {{/if}}
	        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
				<hr>
				<table class="table table-striped table-hover">
					<thead>
						<tr>
							<th>Transfer ID</th>
							<th>Date</th>
							<th>Amount</th>
							<th>Status</th>
						</tr>
					</thead>
					<tbody>
						{{#each customerTransfers}}
							<tr>
								<td>{{this.id}}</td>
								<td>{{this.created}}</td>
								<td>{{this.amount.value}} USD</td>
								<td>{{this.status}}</td>
							</tr>
						{{/each}}
					</tbody>
				</table>
			</div>
		</div>
	</div>
</template>