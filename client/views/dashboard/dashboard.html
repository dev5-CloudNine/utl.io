<template name="dashboard">
    {{#if isInRole 'buyer, dispatcher'}}
        <div class="panel panel-default">
            <div class="panel-body">
                <div class="row">
                    <div class="col-md-3">
                        <div class="widget widget-default widget-item-icon">
                            <a href="/myjobs">                          
                                <div class="widget-data">
                                    <div class="widget-int num-count">{{buyerJobsCount}}</div>
                                    <div class="widget-title">Jobs Posted</div>
                                    <div class="widget-subtitle">
                                        <a href="/myJobs/open">{{buyerOpenJobsCount}} Open</a> &#124; 
                                        <a href="/myJobs/assigned">{{buyerAssignedJobsCount}} Assigned</a> &#124; 
                                        <a href="/myJobs/paid">{{buyerCompletedJobsCount}} Completed</a>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>                    
                    <div class="col-md-3">
                        <div class="widget widget-default widget-item-icon">
                            <div class="widget-data">
                                <div class="widget-int num-count">$ {{amountSpent}}</div>
                                <div class="widget-title">Amount Spent</div>
                                <div class="widget-subtitle">Amount spent on this platform.</div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="widget widget-default widget-item-icon">
                            <div class="widget-data">
                                {{#with myProfile}}
                                    <a href="{{pathFor 'buyerNotifications'}}">
                                        <div class="widget-int num-count">{{buyerNotificationCount currentUser._id}}</div>
                                        <div class="widget-title"> new notifications</div>
                                    </a>
                                {{/with}}
                                <div class="widget-subtitle">
                                    <a href="{{pathFor 'mailBox' tab="mails"}}">{{unreadMsgCount currentUser._id}} unread message(s)</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="widget widget-default widget-padding-sm">
                            {{#with myProfile}}
                                <a href="{{pathFor 'buyer'}}">
                                    <div class="widget-big-int">
                                        <div class="count">
                                            <span class="rateit bigstars" data-rateit-starwidth="32" data-rateit-starheight="32" data-rateit-value="{{buyerRatingPoints}}"></span>
                                        </div>
                                    </div>
                                    <div class="widget-subtitle plugin-date">Reviews ({{buyerReviewCount}})</div>
                                </a>
                            {{/with}}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                <h4>Scheduled Dates of Assigned Jobs</h4>
                {{>buyerCalendar}}
            </div>
        </div>
        <div class="row">
            <hr>
            {{#with myProfile}}
                {{>buyerSmall}}
            {{/with}}
            <div class="col-xs-4 col-sm-4 col-md-8 col-lg-8">
                <div class="panel panel-default">
                    <div class="panel-heading ui-draggable-handle">
                        <div class="panel-title-box">
                            <h3>Projects</h3>
                            <span>Projects activity</span>
                        </div>
                    </div>
                    <div class="panel-body panel-body-table panel-white">
                        <div class="table-responsive">
                            <table class="table table-bordered table-striped">
                                <thead>
                                    <tr>
                                        <th width="50%">Project</th>
                                        <th width="20%">Status</th>
                                        <th width="30%">Activity</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>Joli Admin</strong></td>
                                        <td><span class="label label-danger">Developing</span></td>
                                        <td>
                                            <div class="progress progress-small progress-striped active">
                                                <div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" style="width: 85%;">85%</div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>Gemini</strong></td>
                                        <td><span class="label label-warning">Updating</span></td>
                                        <td>
                                            <div class="progress progress-small progress-striped active">
                                                <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" style="width: 40%;">40%</div>
                                            </div>
                                        </td>
                                    </tr>                                                
                                    <tr>
                                        <td><strong>Taurus</strong></td>
                                        <td><span class="label label-warning">Updating</span></td>
                                        <td>
                                            <div class="progress progress-small progress-striped active">
                                                <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" style="width: 72%;">72%</div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>Leo</strong></td>
                                        <td><span class="label label-success">Support</span></td>
                                        <td>
                                            <div class="progress progress-small progress-striped active">
                                                <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" style="width: 100%;">100%</div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>Virgo</strong></td>
                                        <td><span class="label label-success">Support</span></td>
                                        <td>
                                            <div class="progress progress-small progress-striped active">
                                                <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" style="width: 100%;">100%</div>
                                            </div>
                                        </td>
                                    </tr>                                                
                                    
                                </tbody>
                            </table>
                        </div>
                        
                    </div>
                </div>
            </div>
        </div>
    {{/if}}
    {{#if isInRole 'provider'}}
        <div class="panel panel-default">
            <div class="panel-body">
                <div class="row">
                    <div class="col-md-3">
                        <div class="widget widget-default widget-item-icon">
                            <div class="widget-data">
                                <a href="/jobs">
                                    <div class="widget-int num-count">
                                    {{openJobsCount}}</div>
                                    <div class="widget-title">Open Jobs</div>
                                </a>
                                <div class="widget-subtitle">
                                    <a href="/invitedJobs">{{routedJobsCount}} Routed</a> &#124; 
                                    <a href="/recommendedJobs">{{recommendedJobsCount currentUser._id}} Recommended</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="widget widget-default widget-item-icon">
                            <a href="/assignedJobs">
                                <div class="widget-data">
                                    <div class="widget-int num-count">{{assignedJobsCount}}</div>
                                    <div class="widget-title">Assigned Jobs</div>
                                    <div class="widget-subtitle">Work orders in progress.</div>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="widget widget-default widget-item-icon">
                            <div class="widget-data">
                                {{#with myProfile}}
                                    <a href="{{pathFor 'providerNotifications'}}">
                                        <div class="widget-int num-count">{{providerNotificationCount currentUser._id}}</div>
                                        <div class="widget-title">new notifications</div>
                                    </a>
                                {{/with}}
                                <div class="widget-subtitle">
                                    <a href="{{pathFor 'mailBox' tab="mails"}}">{{unreadMsgCount currentUser._id}} new message(s)</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="widget widget-default widget-padding-sm">
                            {{#with myProfile}}
                                <a href="{{pathFor 'profile'}}">
                                    <div class="widget-big-int">
                                        <div class="count">
                                            <span class="rateit bigstars" data-rateit-starwidth="32" data-rateit-starheight="32" data-rateit-value="{{providerRatingPoints}}"></span>
                                        </div>
                                    </div>
                                    <div class="widget-subtitle plugin-date">Reviews ({{providerReviewCount}})</div>
                                </a>
                            {{/with}}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12">
                <h4>Scheduled Dates of Assigned Jobs</h4>
                {{>providerCalendar}}
            </div>
        </div>
        <div class="row">
            <hr>
            {{#with myProfile}}
                {{>profileSmall}}
            {{/with}}
            <div class="col-xs-4 col-sm-4 col-md-8 col-lg-8">
                <div class="panel panel-default">
                    <div class="panel-heading ui-draggable-handle">
                        <div class="panel-title-box">
                            <h3>Projects</h3>
                            <span>Projects activity</span>
                        </div>
                    </div>
                    <div class="panel-body panel-body-table panel-white">
                        <div class="table-responsive">
                            <table class="table table-bordered table-striped">
                                <thead>
                                    <tr>
                                        <th width="50%">Project</th>
                                        <th width="20%">Status</th>
                                        <th width="30%">Activity</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>Joli Admin</strong></td>
                                        <td><span class="label label-danger">Developing</span></td>
                                        <td>
                                            <div class="progress progress-small progress-striped active">
                                                <div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" style="width: 85%;">85%</div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>Gemini</strong></td>
                                        <td><span class="label label-warning">Updating</span></td>
                                        <td>
                                            <div class="progress progress-small progress-striped active">
                                                <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" style="width: 40%;">40%</div>
                                            </div>
                                        </td>
                                    </tr>                                                
                                    <tr>
                                        <td><strong>Taurus</strong></td>
                                        <td><span class="label label-warning">Updating</span></td>
                                        <td>
                                            <div class="progress progress-small progress-striped active">
                                                <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" style="width: 72%;">72%</div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>Leo</strong></td>
                                        <td><span class="label label-success">Support</span></td>
                                        <td>
                                            <div class="progress progress-small progress-striped active">
                                                <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" style="width: 100%;">100%</div>
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td><strong>Virgo</strong></td>
                                        <td><span class="label label-success">Support</span></td>
                                        <td>
                                            <div class="progress progress-small progress-striped active">
                                                <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100" style="width: 100%;">100%</div>
                                            </div>
                                        </td>
                                    </tr>                                                
                                    
                                </tbody>
                            </table>
                        </div>
                        
                    </div>
                </div>
            </div>
        </div>
    {{/if}}
    {{#if isInRole 'admin'}}
        <div class="panel panel-default">
            <div class="panel-body">
                <div class="row">
                    <div class="col-md-3">
                        <div class="widget widget-default widget-item-icon">
                            <a href="/allUsers">
                                <div class="widget-data">
                                    <div class="widget-int num-count">{{getPublishedCount 'userCount'}}</div>
                                    <div class="widget-title">Profiles</div>
                                    <div class="widget-subtitle">{{buyersCount}} Buyers &#124; {{providersCount}} Providers</div>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="widget widget-default widget-item-icon">
                            <a href="/allJobs">                            
                                <div class="widget-data">
                                    <div class="widget-int num-count">{{getPublishedCount 'adminJobs'}}</div>
                                    <div class="widget-title">Jobs Posted</div>
                                    <div class="widget-subtitle">{{getPublishedCount 'allCompletedJobs'}} Completed &#124; {{allDeactivatedCount}} Deactivated</div>
                                </div>
                            </a>
                        </div>     
                    </div>
                    <div class="col-md-3">
                        <div class="widget widget-default widget-item-icon">
                            <a href="">
                                <div class="widget-data">
                                    <div class="widget-int num-count">20</div>
                                    <div class="widget-title">Bank Transactions</div>
                                    <div class="widget-subtitle">8 Withdrawls &#124; 12 Deposits</div>
                                </div>
                            </a>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="widget widget-info widget-padding-sm">
                            <div class="widget-big-int plugin-clock">03<span>:</span>12</div>
                            <div class="widget-subtitle plugin-date">Tuesday, November 8, 2016</div>
                            <div class="widget-buttons widget-c3">
                                <div class="col">
                                    <a href="#"><span class="fa fa-clock-o"></span></a>
                                </div>
                                <div class="col">
                                    <a href="#"><span class="fa fa-bell"></span></a>
                                </div>
                                <div class="col">
                                    <a href="#"><span class="fa fa-calendar"></span></a>
                                </div>
                            </div>                            
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="panel panel-light">
            <div class="panel-body">
                <div class="row">
                    <div class="col-sm-6">
                        <div id="sampleChart">{{sampleChart}}</div>
                    </div>
                    <div class="col-sm-6">
                        <div id="weekJobs">{{lastWeekJobs}}</div>
                    </div>
                </div>
            </div>
        </div>
        <hr>
        <div class="panel panel-default">
            <div class="panel-body">
                <div class="row">
                    <div class="col-sm-12">
                        <div id="adminChart">{{createChart}}</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="panel panel-default">
            <div class="panel-body">
                <div class="row">
                    <div class="col-sm-12">
                        <div id="tryOut">{{tryoutchart}}</div>
                    </div>
                </div>
            </div>
        </div>
    {{/if}}
</template>

<template name="myGoogleMap">
    <div class="map-container">
        <input type="text" id="place1" class="form-control">
        <div id="myMap"></div>
    </div>
</template>

<template name="providerCalendar">
    <div id="provider-jobs-calendar"></div>
</template>
<template name="buyerCalendar">
    <div id="buyer-jobs-calendar"></div>
</template>